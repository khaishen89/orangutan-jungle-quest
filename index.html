
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OrangUtan Jungle Quest</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script>window.process = { env: { API_KEY: '' } };</script>
    <style>
        body { font-family: 'Fredoka', sans-serif; background-color: #f0fdf4; margin: 0; }
        .jungle-gradient { background: linear-gradient(180deg, #dcfce7 0%, #fef3c7 100%); }
        .wobble { animation: wobble 3s infinite ease-in-out; }
        @keyframes wobble { 0%, 100% { transform: rotate(-2deg); } 50% { transform: rotate(2deg); } }
        .float { animation: float 4s infinite ease-in-out; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
        .bounce-btn { transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .bounce-btn:hover { transform: scale(1.05) translateY(-5px); }
        .bounce-btn:active { transform: scale(0.95) translateY(2px); }
        .sticker-pop { animation: pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes pop { 0% { transform: scale(0.5); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
    </style>
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@19.0.0",
    "react-dom/client": "https://esm.sh/react-dom@19.0.0/client",
    "@google/genai": "https://esm.sh/@google/genai@1.3.0",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
</head>
<body class="jungle-gradient min-h-screen">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect } from 'react';
        import ReactDOM from 'react-dom/client';
        import { GoogleGenAI, Type } from "@google/genai";

        const ai = new GoogleGenAI({ apiKey: process.env.API_KEY || '' });

        const fetchQuiz = async () => {
            try {
                const res = await ai.models.generateContent({
                    model: "gemini-3-flash-preview",
                    contents: "Generate 5 ultra-simple quiz questions for 3-5 year olds about orangutans. Use emojis for options. Short text.",
                    config: {
                        responseMimeType: "application/json",
                        responseSchema: {
                            type: Type.ARRAY,
                            items: {
                                type: Type.OBJECT,
                                properties: {
                                    question: { type: Type.STRING },
                                    options: { type: Type.ARRAY, items: { type: Type.STRING } },
                                    correctAnswer: { type: Type.STRING },
                                    explanation: { type: Type.STRING }
                                },
                                required: ["question", "options", "correctAnswer", "explanation"]
                            }
                        }
                    }
                });
                return JSON.parse(res.text || "[]");
            } catch (e) {
                return [
                    { question: "What do I love to eat?", options: ["Bananas üçå", "Pizza üçï", "Ice Cream üç¶"], correctAnswer: "Bananas üçå", explanation: "Orangutans love fresh fruit!" },
                    { question: "What color is my fur?", options: ["Blue ü¶ã", "Orange üçä", "Green ü•¶"], correctAnswer: "Orange üçä", explanation: "I have beautiful ginger hair!" }
                ];
            }
        };

        const Header = ({ onNavigate }) => {
            const [logo, setLogo] = useState(null);
            const [isLocked, setIsLocked] = useState(false);

            useEffect(() => {
                // Check if the owner uploaded 'brand.png' to GitHub
                fetch('./brand.png', { method: 'HEAD' })
                    .then(res => {
                        if (res.ok) {
                            setLogo('./brand.png');
                            setIsLocked(true); // If found, hide the upload button for everyone
                        } else {
                            const local = localStorage.getItem('temp-brand');
                            if (local) setLogo(local);
                        }
                    })
                    .catch(() => {
                        const local = localStorage.getItem('temp-brand');
                        if (local) setLogo(local);
                    });
            }, []);

            const handleUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (re) => {
                        setLogo(re.target.result);
                        localStorage.setItem('temp-brand', re.target.result);
                    };
                    reader.readAsDataURL(file);
                }
            };

            return (
                <header className="bg-white/90 backdrop-blur-md border-b-8 border-orange-100 p-6 sticky top-0 z-50">
                    <div className="max-w-7xl mx-auto flex flex-col items-center gap-6">
                        {logo ? (
                            <img src={logo} className="h-24 md:h-32 object-contain wobble drop-shadow-md" alt="OrangUtan Brand" />
                        ) : (
                            <label className="cursor-pointer bg-white border-4 border-dashed border-orange-300 rounded-3xl px-12 py-6 flex flex-col items-center gap-2 hover:bg-orange-50 transition-colors">
                                <span className="text-4xl">üñºÔ∏è</span>
                                <span className="text-orange-600 font-bold">UPLOAD BRAND LOGO</span>
                                <input type="file" className="hidden" accept="image/*" onChange={handleUpload} />
                            </label>
                        )}
                        {!isLocked && logo && (
                            <p className="text-[10px] text-gray-400 font-bold uppercase tracking-tighter">Owner Tip: Put "brand.png" in your GitHub repo to lock this for all visitors!</p>
                        )}
                        <nav className="flex gap-4">
                            <button onClick={() => onNavigate('HOME')} className="bg-orange-500 text-white px-8 py-3 rounded-2xl font-bold shadow-[0_5px_0_#c2410c] bounce-btn">HOME üè†</button>
                            <button onClick={() => onNavigate('SCORES')} className="bg-green-500 text-white px-8 py-3 rounded-2xl font-bold shadow-[0_5px_0_#15803d] bounce-btn">SCORES üèÜ</button>
                        </nav>
                    </div>
                </header>
            );
        };

        const Quiz = ({ onEnd }) => {
            const [qs, setQs] = useState([]);
            const [idx, setIdx] = useState(0);
            const [score, setScore] = useState(0);
            const [loading, setLoading] = useState(true);
            const [choice, setChoice] = useState(null);

            useEffect(() => { fetchQuiz().then(d => { setQs(d); setLoading(false); }); }, []);

            if (loading) return <div className="text-center py-20 text-4xl font-bold text-orange-500 animate-bounce">ü¶ß Jungle loading...</div>;

            const q = qs[idx];
            return (
                <div className="max-w-2xl mx-auto bg-white p-8 md:p-12 rounded-[3rem] shadow-2xl border-b-[12px] border-orange-50">
                    <h2 className="text-3xl md:text-5xl font-bold text-gray-800 text-center mb-10">{q.question}</h2>
                    <div className="grid gap-4">
                        {q.options.map(o => (
                            <button 
                                key={o} 
                                disabled={!!choice}
                                onClick={() => { setChoice(o); if(o === q.correctAnswer) setScore(s => s + 10); }}
                                className={`p-6 text-3xl font-bold rounded-3xl border-b-8 transition-all ${
                                    choice ? (o === q.correctAnswer ? 'bg-green-400 border-green-600 text-white' : (o === choice ? 'bg-red-400 border-red-600 text-white' : 'bg-gray-100 border-gray-200 text-gray-300')) 
                                    : 'bg-white border-orange-100 hover:bg-orange-50 active:translate-y-2'
                                }`}
                            >
                                {o}
                            </button>
                        ))}
                    </div>
                    {choice && (
                        <div className="mt-10 text-center sticker-pop">
                            <p className="text-xl font-bold text-orange-700 mb-6 italic">‚ú® {q.explanation}</p>
                            <button 
                                onClick={() => { if(idx < qs.length - 1) { setIdx(idx+1); setChoice(null); } else onEnd(score); }}
                                className="bg-orange-500 text-white text-3xl font-bold px-12 py-4 rounded-full shadow-lg border-b-4 border-orange-700"
                            >
                                NEXT! üëâ
                            </button>
                        </div>
                    )}
                </div>
            );
        };

        const Scores = () => {
            const list = JSON.parse(localStorage.getItem('orang-scores') || '[]')
                .sort((a,b) => b.score - a.score).slice(0, 10);
            return (
                <div className="max-w-xl mx-auto bg-white p-8 rounded-[3rem] shadow-2xl border-b-[12px] border-green-50">
                    <h2 className="text-5xl font-bold text-green-600 text-center mb-10">üèÜ Hall of Fame</h2>
                    <div className="space-y-4">
                        {list.length ? list.map((s, i) => (
                            <div key={i} className={`flex justify-between p-5 rounded-2xl border-4 ${i === 0 ? 'bg-yellow-50 border-yellow-200 scale-105' : 'bg-orange-50 border-orange-100'}`}>
                                <span className="text-2xl font-bold text-orange-600">{i === 0 ? 'ü•á' : `#${i+1}`} {s.name}</span>
                                <span className="text-3xl font-bold text-green-600">{s.score}</span>
                            </div>
                        )) : <p className="text-center text-gray-300 font-bold italic">No explorers yet! Start playing!</p>}
                    </div>
                </div>
            );
        };

        const App = () => {
            const [view, setView] = useState('HOME');
            const [score, setScore] = useState(0);
            const [name, setName] = useState('');

            const save = () => {
                const prev = JSON.parse(localStorage.getItem('orang-scores') || '[]');
                localStorage.setItem('orang-scores', JSON.stringify([...prev, {name, score}]));
                setView('SCORES');
            }

            return (
                <div className="pb-20">
                    <Header onNavigate={setView} />
                    <main className="container mx-auto mt-12 px-4">
                        {view === 'HOME' && (
                            <div className="text-center">
                                <img src="https://picsum.photos/seed/orang/800/600" className="w-full max-w-xl mx-auto rounded-[3rem] shadow-2xl border-[12px] border-white wobble mb-10" />
                                <h1 className="text-7xl font-bold text-orange-600 mb-10 drop-shadow-md">Hello Friend! ü¶ß</h1>
                                <button onClick={() => setView('QUIZ')} className="bg-orange-500 text-white text-5xl font-bold py-8 px-16 rounded-[3rem] shadow-[0_12px_0_#c2410c] bounce-btn">PLAY! üéÆ</button>
                            </div>
                        )}
                        {view === 'QUIZ' && <Quiz onEnd={(s) => { setScore(s); setView('OVER'); }} />}
                        {view === 'SCORES' && <Scores />}
                        {view === 'OVER' && (
                            <div className="max-w-md mx-auto bg-white p-12 rounded-[4rem] shadow-2xl text-center border-b-[16px] border-orange-50">
                                <h2 className="text-4xl font-bold text-orange-600 mb-4">YOU DID IT! üéâ</h2>
                                <div className="text-9xl font-bold text-green-500 mb-10">{score}</div>
                                <input value={name} onChange={e => setName(e.target.value)} placeholder="Type your name!" className="w-full p-5 border-4 border-orange-200 rounded-3xl text-2xl font-bold text-center mb-8 focus:outline-none focus:border-orange-500" />
                                <button onClick={save} disabled={!name} className="w-full bg-green-500 text-white text-3xl font-bold py-6 rounded-[2.5rem] shadow-[0_10px_0_#15803d] bounce-btn disabled:opacity-50">SAVE SCORE! üíé</button>
                            </div>
                        )}
                    </main>
                    <div className="fixed bottom-0 w-full flex justify-center py-6 pointer-events-none opacity-20">
                        <span className="text-6xl float">üåø</span><span className="text-6xl float" style={{animationDelay:'1s'}}>üçå</span><span className="text-6xl float">üå¥</span>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
